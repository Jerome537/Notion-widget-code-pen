<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>MicroPad â€“ Notion Blue</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{
  --bg:#ffffff;
  --surface:#f5f5f5;
  --border:#e0e0e0;
  --accent:#0B6E99;          /* Notion blue (light) */
  --text:#111;
  --muted:#666;
}
@media (prefers-color-scheme: dark){
  :root{
    --bg:#111;
    --surface:#1a1a1a;
    --border:#333;
    --accent:#529CCA;        /* Notion blue (dark) */
    --text:#e6e6e6;
    --muted:#8a8a8a;
  }
}
*{box-sizing:border-box;font-family:Inter,system-ui,monospace}
body{margin:0;height:100vh;display:flex;flex-direction:column;background:var(--bg);color:var(--text)}
header{display:flex;align-items:center;gap:.4rem;padding:.6rem 1rem;background:var(--surface);border-bottom:1px solid var(--border)}
header button{
  padding:.4rem .7rem;
  border:1px solid var(--border);
  border-radius:.4rem;
  background:transparent;
  color:var(--muted);
  font-size:.75rem;
  cursor:pointer;
  transition:all .15s;
}
header button.active,
header button:hover{
  border-color:var(--accent);
  color:var(--accent);
  background:var(--accent)1A;   /* subtle tint */
}
#panel{flex:1;position:relative}
#panel>section{
  position:absolute;
  inset:0;
  display:none;
  flex-direction:column;
}
#panel>section.active{display:flex}
#panel textarea{
  flex:1;
  width:100%;
  border:none;
  resize:none;
  padding:1rem;
  background:transparent;
  color:var(--text);
  font-size:.9rem;
  line-height:1.5;
  outline:none;
}
#preview{
  flex:1;
  width:100%;
  border:none;
  background:#fff;
}
</style>
</head>
<body>

<header>
  <button data-mode="preview" class="mode active">Preview</button>
  <button data-mode="html"   class="mode">HTML</button>
  <button data-mode="css"    class="mode">CSS</button>
  <button data-mode="js"     class="mode">JS</button>
  <button id="exportBtn" style="margin-left:auto;">Export</button>
</header>

<div id="panel">
  <section id="previewPane" class="active">
    <iframe id="preview"></iframe>
  </section>

  <section id="htmlPane">
    <textarea id="html" spellcheck="false" placeholder="<!-- HTML -->"></textarea>
  </section>

  <section id="cssPane">
    <textarea id="css" spellcheck="false" placeholder="/* CSS */"></textarea>
  </section>

  <section id="jsPane">
    <textarea id="js" spellcheck="false" placeholder="// JavaScript"></textarea>
  </section>
</div>

<script>
/* ---------- STORAGE ---------- */
const els = {html:document.getElementById('html'),
             css :document.getElementById('css'),
             js  :document.getElementById('js'),
             preview:document.getElementById('preview')};

['html','css','js'].forEach(k=>{
  const saved = localStorage.getItem(k);
  if(saved) els[k].value = saved;
});

/* ---------- MODE SWITCH ---------- */
const modes = document.querySelectorAll('.mode');
modes.forEach(btn=>btn.addEventListener('click',()=>setMode(btn.dataset.mode)));

function setMode(mode){
  modes.forEach(b=>b.classList.toggle('active',b.dataset.mode===mode));
  document.querySelectorAll('#panel>section')
          .forEach(s=>s.classList.toggle('active',s.id.startsWith(mode)));
  run();
}

/* ---------- LIVE PREVIEW ---------- */
function run(){
  const html = els.html.value;
  const css  = `<style>${els.css.value}</style>`;
  const js   = `<script>${els.js.value}<\/script>`;
  const blob = new Blob([html+css+js],{type:'text/html'});
  els.preview.src = URL.createObjectURL(blob);

  ['html','css','js'].forEach(k=>localStorage.setItem(k,els[k].value));
}
els.html.addEventListener('input',run);
els.css .addEventListener('input',run);
els.js  .addEventListener('input',run);
run();

/* ---------- EXPORT ---------- */
document.getElementById('exportBtn').addEventListener('click',()=>{
  const html = els.html.value;
  const css  = `<style>${els.css.value}</style>`;
  const js   = `<script>${els.js.value}<\/script>`;
  const full = `<!doctype html>
<html lang="fr">
<head><meta charset="UTF-8"><title>Export</title>${css}</head>
<body>${html}${js}</body>
</html>`;
  const blob = new Blob([full],{type:'text/html'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'export.html';
  a.click();
});
</script>
</body>
</html>
