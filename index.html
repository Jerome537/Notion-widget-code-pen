<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>MicroPad ‚Äì Notion Blue</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{
  --bg:#ffffff;
  --surface:#f5f5f5;
  --border:#e0e0e0;
  --accent:#0B6E99;
  --text:#111;
  --muted:#666;
}
@media (prefers-color-scheme: dark){
  :root{
    --bg:#111;
    --surface:#1a1a1a;
    --border:#333;
    --accent:#529CCA;
    --text:#e6e6e6;
    --muted:#8a8a8a;
  }
}
*{box-sizing:border-box;font-family:Inter,system-ui,monospace}
body{margin:0;height:100vh;display:flex;flex-direction:column;background:var(--bg);color:var(--text)}
header{display:flex;align-items:center;gap:.4rem;padding:.6rem 1rem;background:var(--surface);border-bottom:1px solid var(--border)}
header button{
  padding:.4rem .7rem;
  border:1px solid var(--border);
  border-radius:.4rem;
  background:transparent;
  color:var(--muted);
  font-size:.75rem;
  cursor:pointer;
  transition:all .15s;
}
header button.active,
header button:hover{
  border-color:var(--accent);
  color:var(--accent);
  background:var(--accent)1A;
}
#panel{flex:1;position:relative}
#panel>section{
  position:absolute;
  inset:0;
  display:none;
  flex-direction:column;
}
#panel>section.active{display:flex}
#panel textarea{
  flex:1;
  width:100%;
  border:none;
  resize:none;
  padding:1rem;
  background:transparent;
  color:var(--text);
  font-size:.9rem;
  line-height:1.5;
  outline:none;
}
#preview{
  flex:1;
  width:100%;
  border:none;
  background:#fff;
}

/* Style pour le contenu initial dans preview */
.intro-container {
  max-width: 720px;
  margin: 3rem auto;
  padding: 2rem;
  text-align: center;
  background: var(--surface);
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.05);
}
.intro-container img {
  width: 64px;
  margin-bottom: 1rem;
  animation: float 3s ease-in-out infinite;
}
@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-5px); }
}
.intro-container h1 {
  font-size: 2rem;
  color: var(--accent);
  margin-bottom: 1rem;
}
.intro-container h2 {
  font-size: 1.25rem;
  font-weight: 400;
  color: var(--muted);
  margin-bottom: 2rem;
}
.intro-container p {
  font-size: 1rem;
  line-height: 1.6;
  margin-bottom: 1rem;
}
.intro-container footer {
  margin-top: 2rem;
  color: var(--muted);
  font-size: 0.9rem;
}
</style>
</head>
<body>

<header>
  <button data-mode="preview" class="mode active">Preview</button>
  <button data-mode="html"   class="mode">HTML</button>
  <button data-mode="css"    class="mode">CSS</button>
  <button data-mode="js"     class="mode">JS</button>
  <button id="exportBtn" style="margin-left:auto;">Export</button>
</header>

<div id="panel">
  <section id="previewPane" class="active">
    <iframe id="preview"></iframe>
  </section>

  <section id="htmlPane">
    <textarea id="html" spellcheck="false" placeholder="<!-- HTML -->"></textarea>
  </section>

  <section id="cssPane">
    <textarea id="css" spellcheck="false" placeholder="/* CSS */"></textarea>
  </section>

  <section id="jsPane">
    <textarea id="js" spellcheck="false" placeholder="// JavaScript"></textarea>
  </section>
</div>

<script>
const els = {
  html: document.getElementById('html'),
  css: document.getElementById('css'),
  js: document.getElementById('js'),
  preview: document.getElementById('preview')
};

// Contenu d‚Äôintroduction √† injecter √† la premi√®re ouverture
const defaultHTML = `
  <div class="intro-container">
    <img src="https://upload.wikimedia.org/wikipedia/commons/4/45/Notion_app_logo.png" alt="Notion Logo" />
    <h1>Bienvenue dans ton widget Notion üéâ</h1>
    <h2>CodePad ‚Äì Bleu Notion</h2>
    <p>Colle ton code HTML dans l'onglet <strong>HTML</strong>, et si besoin dans les onglets <strong>CSS</strong> ou <strong>JS</strong> selon le contenu que tu veux afficher.</p>
    <p>Le bouton <strong>Preview</strong> te permet de visualiser le rendu en direct dans l‚Äô√©diteur.</p>
    <p>Le bouton <strong>Exporter</strong> ne fonctionne pas directement dans Notion, mais tu peux cliquer sur la petite <strong>fl√®che de commande Notion</strong> (en haut √† droite du bloc) pour ouvrir l'app dans une nouvelle fen√™tre.</p>
    <p>Une fois dans la version externe, le bouton Exporter cr√©era un fichier HTML que tu pourras ouvrir dans ton navigateur ou envoyer √† quelqu‚Äôun.</p>
    <footer>Made with ‚ù§Ô∏è by J√©r√¥me, Kimmy & ChatGPT</footer>
  </div>
`;

if (!localStorage.getItem('html')) localStorage.setItem('html', defaultHTML);

['html','css','js'].forEach(k=>{
  const saved = localStorage.getItem(k);
  if(saved) els[k].value = saved;
});

/* ---------- Mode Switch ---------- */
const modes = document.querySelectorAll('.mode');
modes.forEach(btn=>btn.addEventListener('click',()=>setMode(btn.dataset.mode)));

function setMode(mode){
  modes.forEach(b=>b.classList.toggle('active',b.dataset.mode===mode));
  document.querySelectorAll('#panel>section')
          .forEach(s=>s.classList.toggle('active',s.id.startsWith(mode)));
  run();
}

/* ---------- Live Preview ---------- */
function run(){
  const html = els.html.value;
  const css  = `<style>${els.css.value}</style>`;
  const js   = `<script>${els.js.value}<\/script>`;
  const blob = new Blob([html+css+js],{type:'text/html'});
  els.preview.src = URL.createObjectURL(blob);
  ['html','css','js'].forEach(k=>localStorage.setItem(k,els[k].value));
}
els.html.addEventListener('input',run);
els.css .addEventListener('input',run);
els.js  .addEventListener('input',run);
run();

/* ---------- Export ---------- */
document.getElementById('exportBtn').addEventListener('click',()=>{
  const html = els.html.value;
  const css  = `<style>${els.css.value}</style>`;
  const js   = `<script>${els.js.value}<\/script>`;
  const full = `<!doctype html>
<html lang="fr">
<head><meta charset="UTF-8"><title>Export</title>${css}</head>
<body>${html}${js}</body>
</html>`;
  const blob = new Blob([full],{type:'text/html'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'export.html';
  a.click();
});
</script>
</body>
</html>
